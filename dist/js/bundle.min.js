var RunningArrow=function(r,i){var a={lines:i.lines||[],circles:i.circles||[],widthArrow:i.widthArrow||200,weightArrow:i.weightArrow||4,colorArrow:i.colorArrow||"#FC273D",colorLines:i.colorLines||"rgba(255, 100, 75, 1)",weightLines:i.weightLines||2,circleRadius:i.circleRadius||10,circleColor:i.circleColor||"#ffffff",start:i.start||{x:i.widthArrow||200,y:10},dir:i.dir||{x:1,y:0},widthArrowPart:i.widthArrowPart||10},o=a.dir.x,l=a.dir.y,w=[{x:a.start.x,y:a.start.y}],c=1100,y=210,t=document.getElementById(r),x=t.getContext("2d"),e=a.lines.reduce(function(r,i){var t=Math.max(i.x1,i.x2),e=Math.max(i.y1,i.y2);return r.w=Math.max(r.w,t),r.h=Math.max(r.h,e),r},{w:0,h:0});t.width=e.w+a.circleRadius,t.height=e.h+a.circleRadius;var n,h,s=1e3/600,d=Date.now();function u(){return function(r){if(null==r||"object"!=typeof r)return r;var i=r.constructor();for(var t in r)r.hasOwnProperty(t)&&(i[t]=r[t]);return i}(w[w.length-1])}function A(r,i,t,e,n,o){x.strokeStyle=n||a.colorLines,x.lineWidth=o||a.weightLines,x.beginPath(),x.moveTo(r,i),x.lineTo(t,e),x.stroke()}function f(){x.clearRect(0,0,c,y),function(){x.lineWidth=1;for(var r=0;r<a.lines.length;r++){var i=a.lines[r];A(i.x1,i.y1,i.x2,i.y2)}}(),function(){var r=u();w.shift(),r.x+=o,r.y+=l,w.push(r)}(),function(){x.fillStyle=a.colorArrow;for(var r=0;r<w.length;r++)x.fillRect(w[r].x-a.weightArrow/2,w[r].y-a.weightArrow/2,a.weightArrow,a.weightArrow)}(),function(){var r=u(),i={x:r.x,y:r.y},t={x:1===o||-1===l?r.x-a.widthArrowPart:1===l?r.x+a.widthArrowPart:0,y:1===o||1===l?r.y-a.widthArrowPart:-1===l?r.y+a.widthArrowPart:0};A(i.x,i.y,t.x,t.y,a.colorArrow,a.weightArrow);var e={x:r.x,y:r.y},n={x:1===o||1===l?r.x-a.widthArrowPart:-1===l?r.x+a.widthArrowPart:0,y:1===o||-1===l?r.y+a.widthArrowPart:1===l?r.y-a.widthArrowPart:0};A(e.x,e.y,n.x,n.y,a.colorArrow,a.weightArrow)}(),function(){for(var r=x.lineWidth=0;r<a.circles.length;r++){var i=a.circles[r];t=i.x,e=i.y,n=a.circleRadius,x.fillStyle=a.circleColor,x.lineWidth=0,x.beginPath(),x.arc(t,e,n,0,2*Math.PI),x.fill()}var t,e,n}();for(var r,i,t=u(),e=0;e<a.lines.length;e++){var n=a.lines[e];t.x===n.x2&&t.y===n.y2&&("object"==typeof n.start?(w[w.length-1].x=n.start.x,w[w.length-1].y=n.start.y):(r=n.dir.x,i=n.dir.y,o=r,l=i))}}console.log(111);var m=requestAnimationFrame||webkitRequestAnimationFrame||mozRequestAnimationFrame||oRequestAnimationFrame||msRequestAnimationFrame||function(r){window.setTimeout(r,1e3/60)},g=cancelAnimationFrame||webkitCancelAnimationFrame||mozCancelAnimationFrame||oCancelAnimationFrame||msCancelAnimationFrame||function(r){window.setTimeout(r,1e3/60)};function v(){loopId=m(v),h=Date.now(),s<(n=h-d)&&(d=h-n%s),f()}!function(){for(var r=1;r<a.widthArrow;r++){var i=w.length-r,t=w[i],e={x:t.x-o,y:t.y-l};w.unshift(e)}}(),this.run=function(){v()},this.stop=function(){g(loopId)}},line=new RunningArrow("line-img",{lines:[{x1:10,y1:10,x2:250,y2:10,dir:{x:0,y:1}},{x1:250,y1:10,x2:250,y2:200,dir:{x:1,y:0}},{x1:250,y1:200,x2:530,y2:200,dir:{x:0,y:-1}},{x1:530,y1:200,x2:530,y2:60,dir:{x:1,y:0}},{x1:530,y1:60,x2:810,y2:60,dir:{x:0,y:1}},{x1:810,y1:60,x2:810,y2:200,dir:{x:1,y:0}},{x1:810,y1:200,x2:1070,y2:200,start:{x:10,y:10}}],circles:[{x:10,y:10},{x:250,y:200},{x:530,y:60},{x:810,y:200}],widthArrow:200});line.run();